# Task №5

* Настроить статическую конфигурацию (без DHCP) в Ubuntu через ip и netplan. 
* Настроить IP, маршрут по умолчанию и DNS-сервера (1.1.1.1 и 8.8.8.8). 
  Проверить работоспособность сети.
* Настроить правила iptables для доступности сервисов на TCP-портах 22, 80 и 443. 
* Также сервер должен иметь возможность устанавливать подключения к серверу обновлений. 
  Остальные подключения запретить.
* Запретить любой входящий трафик с IP 3.4.5.6.
* Запросы на порт 8090 перенаправлять на порт 80 (на этом же сервере).
* Разрешить подключение по SSH только из сети 192.168.0.0/24.

Сравнить с [эталонным решением](Домашнее_задание_5.pdf).

# Solution №5

### Настроить статическую конфигурацию (без DHCP) в Ubuntu через ip и netplan.
### Настроить IP, маршрут по умолчанию и DNS-сервера (1.1.1.1 и 8.8.8.8).
Для редактирования конфиг файла в редакторе ```nano``` нужно в консоли ввести:

```linux
sudo nano /etc/netplan/01-network-manager-all.yalm
```

Для этой задачи нам понадобится следующая конфигурация:

  ```linux
  network:
    version: 2
    renderer: networkd
    ethernets:
      enp3s0:
        dhcp4: no
        addresses: [192.168.2.19/24]
        routes:
          - to: default
            via: 192.168.2.255
        nameservers:
          addresses: 
          - 8.8.8.8
          - 1.1.1.1
  ```

После чего нажимаем ```Ctrl+O``` что бы сохранить и ```CTRL+X``` выход.<br>

Перезапускаем сеть:

```linux
sudo service networking restart
```

* #### Проверить работоспособность сети.

Вводим в консоли команду:

```linux
ping ya.ru
```

Если сайт пингуется, то сеть работает.


### Настроить правила iptables для доступности сервисов на TCP-портах 22, 80 и 443.
Смотрим базовую таблицу фильтров:

```linux
sudo iptables -L
```

Меняем политику для цепочки INPUT:

```linux
sudo iptables -P INPUT DROP
```

Затем разрешаем все входящие соединения от локального
интерфейса:

```linux
sudo iptables -A INPUT -i lo -j ACCEPT
```

Затем разрешаем доступ к портам 22, 80, 443:

```linux
iptables -A INPUT -p tcp --match multiport --dports 22,80,443 -j ACCEPT
```

* Также сервер должен иметь возможность устанавливать подключения к серверу обновлений.
* Остальные подключения запретить.


### Запретить любой входящий трафик с IP 3.4.5.6.

```linux
sudo iptables -t filter -A INPUT -s 3.4.5.6. -j REJECT
```

### Запросы на порт 8090 перенаправлять на порт 80 (на этом же сервере).

```linux
sudo iptables -t nat -I PREROUTING -p tcp --dport 8090 -j REDIRECT --to-port 80
```

Проверка:

```linux
sudo iptables -L -nv -t nat
```

### Разрешить подключение по SSH только из сети 192.168.0.0/24.

```linux
sudo iptables -t filter -A INPUT -p tcp -s 192.168.0.0/24 --dport 8090 -j ACCEPT
```